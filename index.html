<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Unisonic Hockey Game</title>
  <style>
    canvas {
      background: black;
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const paddleWidth = 10, paddleHeight = 60, puckSize = 10;
    let leftPaddleY = 270;
    let rightPaddleY = 270;
    let puckX = 395, puckY = 295;
    let puckSpeedX = 4, puckSpeedY = 2;

    let leftScore = 0, rightScore = 0;
    let gameState = 'menu';

    const goalTop = 150;
    const goalBottom = 450;

    const heldKeys = new Set();

    function playBeep(frequency = 440, duration = 100) {
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      oscillator.type = 'square';
      oscillator.frequency.setValueAtTime(frequency, audioCtx.currentTime);
      gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      oscillator.start();
      oscillator.stop(audioCtx.currentTime + duration / 1000);
    }

    function drawRect(x, y, w, h) {
      ctx.fillStyle = "white";
      ctx.fillRect(x, y, w, h);
    }

    function drawScore() {
  ctx.font = "60px Arial";
  ctx.fillStyle = "white";
  ctx.textAlign = "left";
  ctx.fillText(leftScore, canvas.width / 4, 60); // centered between left wall and center
  ctx.textAlign = "right";
  ctx.fillText(rightScore, canvas.width * 3 / 4, 60); // centered between right wall and center
}

    function drawBordersAndGoals() {
      ctx.strokeStyle = "white";
      ctx.lineWidth = 12;
      ctx.setLineDash([6, 4]);
      ctx.beginPath();
      ctx.moveTo(10, 0);
      ctx.lineTo(canvas.width - 10, 0);
      ctx.moveTo(10, canvas.height);
      ctx.lineTo(canvas.width - 10, canvas.height);
      ctx.moveTo(0, 0);
      ctx.lineTo(0, goalTop);
      ctx.moveTo(0, goalBottom);
      ctx.lineTo(0, canvas.height);
      ctx.moveTo(canvas.width, 0);
      ctx.lineTo(canvas.width, goalTop);
      ctx.moveTo(canvas.width, goalBottom);
      ctx.lineTo(canvas.width, canvas.height);
      ctx.stroke();
      ctx.setLineDash([]);
    }

    function drawGoals() {
      ctx.fillStyle = "black";
      ctx.fillRect(0, goalTop, 10, goalBottom - goalTop);
      ctx.fillRect(canvas.width - 10, goalTop, 10, goalBottom - goalTop);
    }

    function drawMenu(text) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.font = "40px Arial";
  ctx.fillStyle = "white";
  ctx.textAlign = "center";
  ctx.fillText(text, canvas.width / 2, canvas.height / 2);
  ctx.font = "20px Arial";
  ctx.fillText("(Click anywhere to enable controls)", canvas.width / 2, canvas.height / 2 + 30);
  ctx.fillText("Controls:", canvas.width / 2, canvas.height / 2 + 60);
  ctx.fillText("W/S = Left Player Up/Down", canvas.width / 2, canvas.height / 2 + 90);
  ctx.fillText("Arrow Up/Down = Right Player Up/Down", canvas.width / 2, canvas.height / 2 + 120);
  ctx.fillText("G = Start | R = Replay | Q = Quit", canvas.width / 2, canvas.height / 2 + 150);
}

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawScore();
      drawBordersAndGoals();
      drawGoals();

      for (let y = 0; y < canvas.height; y += 20) {
        drawRect(canvas.width / 2 - 2, y, 4, 10);
      }

      drawRect(20, leftPaddleY, paddleWidth, paddleHeight);
      drawRect(480, leftPaddleY, paddleWidth, paddleHeight);
      drawRect(770, rightPaddleY, paddleWidth, paddleHeight);
      drawRect(300, rightPaddleY, paddleWidth, paddleHeight);

      drawRect(puckX, puckY, puckSize, puckSize);
    }

    function updatePaddles() {
      if (heldKeys.has('w')) leftPaddleY -= 8;
      if (heldKeys.has('s')) leftPaddleY += 8;
      if (heldKeys.has('ArrowUp')) rightPaddleY -= 8;
      if (heldKeys.has('ArrowDown')) rightPaddleY += 8;
    }

    let serveTimeout = null;
    let serveDirection = 1;

    function servePuck(fromRight) {
      serveDirection = fromRight ? -1 : 1;
      puckX = fromRight ? canvas.width - 20 : 20;
      puckY = Math.random() * (canvas.height - puckSize * 2);
      let angle = (Math.random() - 0.5) * 6;
      puckSpeedX = serveDirection * 6;
      puckSpeedY = angle;
    }

    function update() {
      updatePaddles();

      puckX += puckSpeedX;
      puckY += puckSpeedY;

      if (puckX <= 10 && puckY >= goalTop && puckY + puckSize <= goalBottom && gameState !== 'serving') {
        rightScore++;
        playBeep(900);
        gameState = 'serving';
        clearTimeout(serveTimeout);
        serveTimeout = setTimeout(() => {
          gameState = 'playing';
          servePuck(false);
        }, 1000);
      } else if (puckX + puckSize >= canvas.width - 10 && puckY >= goalTop && puckY + puckSize <= goalBottom && gameState !== 'serving') {
        leftScore++;
        playBeep(900);
        gameState = 'serving';
        clearTimeout(serveTimeout);
        serveTimeout = setTimeout(() => {
          gameState = 'playing';
          servePuck(true);
        }, 1000);
      }

      if ((puckX <= 10 && (puckY < goalTop || puckY + puckSize > goalBottom)) ||
          (puckX + puckSize >= canvas.width - 10 && (puckY < goalTop || puckY + puckSize > goalBottom))) {
        puckSpeedX *= -1;
        playBeep(300);
      }

      if (puckY <= 10 || puckY + puckSize >= canvas.height - 10) {
        if (!((puckX <= 10 && puckY >= goalTop && puckY + puckSize <= goalBottom) ||
              (puckX + puckSize >= canvas.width - 10 && puckY >= goalTop && puckY + puckSize <= goalBottom))) {
          puckSpeedY *= -1;
          playBeep(500);
        }
      }

      function paddleHit(px, py, paddleX, paddleY, direction) {
        const withinX = direction === 'left' ? (px < paddleX + paddleWidth && px + puckSize > paddleX) :
                                               (px + puckSize > paddleX && px < paddleX + paddleWidth);
        return withinX && py < paddleY + paddleHeight && py + puckSize > paddleY;
      }

      const leftPaddles = [
        { x: 20, y: leftPaddleY, type: 'defensive' },
        { x: 480, y: leftPaddleY, type: 'offensive' }
      ];

      const rightPaddles = [
        { x: 770, y: rightPaddleY, type: 'defensive' },
        { x: 300, y: rightPaddleY, type: 'offensive' }
      ];

      leftPaddles.forEach(p => {
        if (paddleHit(puckX, puckY, p.x, p.y, 'left')) {
          if (p.type === 'defensive' || puckX < p.x) {
            let hitPos = (puckY + puckSize / 2 - (p.y + paddleHeight / 2)) / (paddleHeight / 2);
            puckSpeedX = Math.abs(puckSpeedX);
            puckSpeedY = hitPos * 5;
            playBeep(600);
          }
        }
      });

      rightPaddles.forEach(p => {
        if (paddleHit(puckX, puckY, p.x, p.y, 'right')) {
          if (p.type === 'defensive' || puckX + puckSize > p.x + paddleWidth) {
            let hitPos = (puckY + puckSize / 2 - (p.y + paddleHeight / 2)) / (paddleHeight / 2);
            puckSpeedX = -Math.abs(puckSpeedX);
            puckSpeedY = hitPos * 5;
            playBeep(600);
          }
        }
      });

      if ((leftScore >= 15 || rightScore >= 15) && gameState !== 'serving') {
        gameState = 'gameover';
      }
    }

    function gameLoop() {
      if (gameState === 'menu') {
        drawMenu('Press "G" to Start');
        return;
      } else if (gameState === 'gameover') {
        drawMenu(`Game Over! ${leftScore > rightScore ? 'Left' : 'Right'} Wins! Press "R" to Replay or "Q" to Quit`);
        return;
      }

      update();
      draw();
    }

    setInterval(gameLoop, 1000 / 60);

    document.addEventListener("keydown", (e) => {
      heldKeys.add(e.key);

      if (gameState === 'menu' && e.key.toLowerCase() === 'g') {
        gameState = 'playing';
        leftScore = 0;
        rightScore = 0;
        puckX = 395;
        puckY = 295;
      } else if (gameState === 'gameover') {
        if (e.key.toLowerCase() === 'r') {
          gameState = 'playing';
          leftScore = 0;
          rightScore = 0;
          puckX = 395;
          puckY = 295;
        } else if (e.key.toLowerCase() === 'q') {
          drawMenu('Thanks for playing!');
        }
      }
    });

    document.addEventListener("keyup", (e) => {
      heldKeys.delete(e.key);
    });
  canvas.addEventListener("mousedown", () => {
  canvas.focus();
});
</script>
</body>
</html>
